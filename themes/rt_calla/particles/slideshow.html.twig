{% extends '@nucleus/partials/particle.html.twig' %}

{% block particle %}
    {% if particle.demo == "enabled" %}
        {% if gantry.theme.preset %}
            {% set preset = gantry.theme.preset | replace({'preset': ''}) - 1 %}
        {% else %}
            {% set preset = '0' %}
        {% endif %}
    {% else %}
        {% set preset = '0' %}
    {% endif %}

    <div id="{{ id }}" class="g-slideshow {{ particle.class|e }}" data-slideshow-id="{{ id }}" data-slideshow-autoplay="{% if particle.autoplay == "enabled" %}true{% else %}false{% endif %}" data-slideshow-timeout="{{ particle.autoplayTimeout }}" data-slideshow-speed="{{ particle.speed }}" data-slideshow-dots="{% if particle.dots == "enabled" %}true{% else %}false{% endif %}" data-slideshow-items="{{ particle.amount }}" data-slideshow-itemstablet="{{ particle.tablet_amount }}" data-slideshow-itemsmobile="{{ particle.mobile_amount }}" data-slideshow-itemssmallmobile="{{ particle.smallmobile_amount }}" data-slideshow-rtl="{% if gantry.page.direction == 'rtl' %}true{% else %}false{% endif %}" data-slideshow-mobile="{{ gantry.config.get('styles.breakpoints.large-mobile-container')|default('30rem') }}" data-slideshow-tablet="{{ gantry.config.get('styles.breakpoints.tablet-container')|default('51rem') }}" data-slideshow-desktop="{{ gantry.config.get('styles.breakpoints.desktop-container')|default('76rem') }}" data-slideshow-preset="{{ preset }}">

        <div class="g-slideshow-carousel g-owlcarousel owl-carousel" data-slideshow-carousel-id="{{ id }}" data-slideshow-carousel-nav="{{ particle.nav == 'enabled' ? 'true' : 'false' }}">
            {% if not particle.source or particle.source == 'particle' %}
                {% for item in particle.items %}
                    <div>
                        <div class="g-slideshow-carousel-image-container" style="background-image: url({{ url(item.image)|e }});">
                            {% if particle.thumbs == 'enabled' and item.image_small %}
                                <div class="g-slideshow-carousel-image-small">
                                    <img src="{{ url(item.image_small)|e }}" alt="{{ item.alt }}" />
                                    {% if item.title_small %}<div class="g-slideshow-carousel-title-small">{{ item.title_small }}</div>{% endif %}
                                </div>
                            {% endif %}

                            {% if item.title %}
                                <h3 class="g-slideshow-carousel-title">
                                    {% if item.link %}
                                        <a href="{{ url(item.link)|e }}" target="{{ item.linktarget|default('_self') }}">
                                    {% endif %}

                                        {{ item.title }}

                                    {% if item.link %}
                                        </a>
                                    {% endif %}
                                </h3>
                            {% endif %}
                        </div>
                    </div>
                {% endfor %}
            {% else %}
                {% include '@particles/slideshow-' ~ gantry.platform.name ~ '.html.twig' ignore missing %}
            {% endif %}
        </div>
    </div>
{% endblock %}

{% block javascript_footer %}
    {% do gantry.load('jquery') %}
    {% do gantry.document.addScript(url('gantry-theme://js/owlcarousel.js'), 10, 'footer') %}
    {% do gantry.document.addScript(url('gantry-theme://js/length.min.js'), 10, 'footer') %}
    {% do gantry.document.addScript(url('gantry-theme://js/slideshow.init.js'), 10, 'footer') %}
{% endblock %}
