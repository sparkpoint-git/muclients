{% extends '@nucleus/partials/particle.html.twig' %}

{% do gantry.load('lightcase.init') %}

{% block particle %}
<div class="{{ particle.class|e }}">
    {% if particle.title %}<h2 class="g-title">{{ particle.title|raw }}</h2>{% endif %}

    <div class="g-popupmodule">
        <div class="g-popupmodule-button">
            <div class="g-popupmodule-button-wrapper">
                {% if not is_user_logged_in %}
                    <a data-rel="lightcase" href="#g-popupmodule-{{ id }}" title="{{ particle.guestbuttontext|e }}" class="button {{ particle.buttonclass|e }}">
                        {% if particle.guestbuttonicon %}<span class="{{ particle.guestbuttonicon|e }} g-popupmodule-button-icon"></span>{% endif %}
                        {{ particle.guestbuttontext|e }}
                    </a>
                {% else %}
                    <a data-rel="lightcase" href="#g-popupmodule-{{ id }}" title="{{ particle.userbuttontext|e }}" class="button {{ particle.buttonclass|e }}">
                        {% if particle.userbuttonicon %}<span class="{{ particle.userbuttonicon|e }} g-popupmodule-button-icon"></span>{% endif %}
                        {{ particle.userbuttontext|e }}
                    </a>
                {% endif %}
            </div>

            <div id="g-popupmodule-{{ id }}" class="g-popupmodule-module-wrapper">
                {{ gantry.platform.displayWidget(particle.widget_id, {'chrome': particle.chrome|default('gantry'), 'position': 'particle'})|raw }}
            </div>
        </div>
    </div>

</div>
{% endblock %}
